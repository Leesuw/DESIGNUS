<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.designus.www.dao.IauctionDao">

	<insert id="getAuctionWriteInsert" parameterType="auction">
		INSERT INTO AU VALUES(AU_SEQ.NEXTVAL,#{au_mbid_w},#{au_title},#{au_cgcode},#{au_qty},#{au_minprice},#{au_inprice},#{au_contents},DEFAULT)
	</insert>

	<insert id="getAuctionBasketInsert" parameterType="basket">
		INSERT INTO AUCTION_BASKET VALUES(${ab_aunum},#{ab_mbid})
	</insert>
	
	<delete id="getAuctionBasketDelete" parameterType="basket">
		DELETE FROM AUCTION_BASKET WHERE AB_AUNUM = ${ab_aunum} AND AB_MBID = #{ab_mbid}
	</delete>
		
	<select id="getAuctionBasketSelect" parameterType="basket" resultType="Integer">
		SELECT NVL(max(ab_aunum),0)FROM AUCTION_BASKET WHERE AB_AUNUM = ${ab_aunum} AND AB_MBID = #{ab_mbid}
	</select>	

	<select id="getAuctionListSelect" parameterType="auction" resultType="auction">
		SELECT * FROM AU WHERE AU_CGCODE = ${au_cgcode}
	</select>

	<select id="getAuctionReadSelect" parameterType="auction" resultType="auction">
		SELECT * FROM AU WHERE AU_NUM = ${au_num}
	</select>

	<select id="getAuctionTenderPrice" parameterType="auctiontender" resultType="Integer">
		SELECT AU_INPRICE FROM AU WHERE AU_NUM = ${aut_aunum}
	</select>

	<insert id="setAuctionTenderI" parameterType="auctiontender">
		INSERT INTO AUCTIONTENDER VALUES(${aut_aunum},#{aut_mbid},${aut_price},'I')
	</insert>

	<update id="setAuctionTenderDel" parameterType="auctiontender">
		UPDATE AU SET AU_QTY = AU_QTY-(${aut_price}/AU_INPRICE) WHERE AU_NUM = ${aut_aunum}
	</update>


</mapper>